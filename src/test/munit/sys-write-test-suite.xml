<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:file="http://www.mulesoft.org/schema/mule/file"
	xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:munit="http://www.mulesoft.org/schema/mule/munit" xmlns:munit-tools="http://www.mulesoft.org/schema/mule/munit-tools"
	xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xsi:schemaLocation="
		http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
		http://www.mulesoft.org/schema/mule/munit http://www.mulesoft.org/schema/mule/munit/current/mule-munit.xsd
		http://www.mulesoft.org/schema/mule/munit-tools  http://www.mulesoft.org/schema/mule/munit-tools/current/mule-munit-tools.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd
http://www.mulesoft.org/schema/mule/file http://www.mulesoft.org/schema/mule/file/current/mule-file.xsd">
	<munit:config name="sys-write-test-suite.xml" />
	<munit:test name="sys-write-test-suite-sys-write:\write-to-file:FlowTest" doc:id="7f17b9e7-6209-44ae-b2d4-6a91b73ef7be" description="Test">
		<munit:execution >
			<ee:transform doc:name="Transform Message" doc:id="2e7af221-67fe-44cd-a9e9-c21ed09dd49c" >
				<ee:message >
				</ee:message>
				<ee:variables >
					<ee:set-variable variableName="fileName" ><![CDATA[%dw 2.0
output application/json
---
'qotd_' ++ now() as String{format: "MMDDYY"} ++ '.txt']]></ee:set-variable>
					<ee:set-variable variableName="quote" ><![CDATA[%dw 2.0
output application/java
---
{
	"engQuote" : "You should never view your challenges as a disadvantage. Instead, it's important for you to understand that your experience facing and overcoming adversity is actually one of your biggest advantages._Michelle Obama_03172020"
}]]></ee:set-variable>
					<ee:set-variable variableName="toWriteEngQuote" ><![CDATA[%dw 2.0
output application/json
---
'qotd_' ++ now() as String{format: "MMddyy"} ++ '.txt'
]]></ee:set-variable>
				</ee:variables>
			</ee:transform>
			<flow-ref doc:name="Flow-ref to sys-write:\write-to-file:Flow" doc:id="57189ea5-4d27-41a7-8911-55f8afff1065" name="sys-write:\write-to-file:Flow"/>
			<file:read doc:name="Read" doc:id="5cad8839-32d2-47ab-b529-fe2045a3a002" config-ref="File_Config" path="#[vars.fileName]"/>
			<ee:transform doc:name="Transform Message" doc:id="5087179f-8817-44cd-825a-6c61b063913a">
				<ee:message>
					<ee:set-payload><![CDATA[%dw 2.0
output text/plain
---
payload]]></ee:set-payload>
				</ee:message>
			</ee:transform>
		</munit:execution>
		<munit:validation >
			<munit-tools:assert-that doc:name="Assert that" doc:id="e4a5cd55-0afe-4fba-8d84-e6ef517fa45c" is="#[MunitTools::equalTo(&quot;You should never view your challenges as a disadvantage. Instead, it's important for you to understand that your experience facing and overcoming adversity is actually one of your biggest advantages._Michelle Obama_03172020&quot;)]" expression="#[payload]"/>
		</munit:validation>
	</munit:test>
	<munit:test name="sys-write-test-suiteTest" doc:id="ba0a5617-16d1-480b-98ec-29c88ec07cce" expectedErrorType="FILE:CONNECTIVITY">
		<munit:execution >
			<flow-ref doc:name="Flow Reference" doc:id="1c953016-1971-46d7-abf1-8bd0d5619ee8" name="sys-write:\write-to-file:Flow"/>
		</munit:execution>
		<munit:validation >
			<munit-tools:assert-that doc:name="Assert that" doc:id="883bda81-f81e-4c3b-a206-db42db25ae1f" is='#[MunitTools::equalTo("Unable to connect to file.")]' expression="#[payload.message]"/>
		</munit:validation>
	</munit:test>
	<munit:test name="sys-write-test-suiteTest1" doc:id="520dbd82-ae1a-46ac-895f-ebbfe81e9de6" expectedErrorType="FILE:ACCESS_DENIED">
		<munit:execution >
			<flow-ref doc:name="Flow Reference" doc:id="e36909b6-48a7-4df3-b0f3-a2f25454dd38" name="sys-write:\write-to-file:Flow"/>
		</munit:execution>
		<munit:validation >
			<munit-tools:assert-that doc:name="Assert that" doc:id="4cc73a2f-cfdf-4c67-b3da-18bd901fdc5c" is='#[MunitTools::notNullValue("Unable to access file.")]' expression="#[payload.message]"/>
		</munit:validation>
	</munit:test>

</mule>
