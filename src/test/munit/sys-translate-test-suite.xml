<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:munit="http://www.mulesoft.org/schema/mule/munit" xmlns:munit-tools="http://www.mulesoft.org/schema/mule/munit-tools"
	xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xsi:schemaLocation="
		http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
		http://www.mulesoft.org/schema/mule/munit http://www.mulesoft.org/schema/mule/munit/current/mule-munit.xsd
		http://www.mulesoft.org/schema/mule/munit-tools  http://www.mulesoft.org/schema/mule/munit-tools/current/mule-munit-tools.xsd">
	<munit:config name="sys-translate-test-suite.xml" />
	<munit:test name="sys-translate-test-suite:\call-translation:FlowTest" doc:id="a4287f43-7bf2-45da-a480-9e74f693df9d" description="Test">
		<munit:behavior >
			<munit-tools:mock-when doc:name="Mock when" doc:id="fd2f2a2c-54b9-4418-8e71-77137b70bcf4" processor="http:request">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="HTTPS POST Translate Quote of the Day XML API" attributeName="doc:name" />
				</munit-tools:with-attributes>
			</munit-tools:mock-when>
		</munit:behavior>
		<munit:execution >
			<flow-ref doc:name="Flow-ref to sys-translate:\call-translation:Flow" doc:id="a048015c-8ac4-496f-924e-7c095e3ebabb" name="sys-translate:\call-translation:Flow"/>
		</munit:execution>
		<munit:validation>
			<munit-tools:verify-call doc:name="Verify call" doc:id="4bf6ccb1-9157-4673-8dcf-f99a0902558c" processor="logger">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="Log Start Translate Quote of the Day" attributeName="doc:name" />
				</munit-tools:with-attributes>
			</munit-tools:verify-call>
			<munit-tools:verify-call doc:name="Verify call" doc:id="a1c6feb2-806c-4597-b983-4454d384a24e" processor="logger">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="Log End Translate Quote of the Day" attributeName="doc:name" />
				</munit-tools:with-attributes>
			</munit-tools:verify-call>
		</munit:validation>
	</munit:test>
	<munit:test name="sys-translate-test-suite:\call-translation-connectivity:FlowTest" doc:id="3f96f247-19cc-48e9-a5fb-ad707ef81204" expectedErrorType="HTTP:CONNECTIVITY">
		<munit:behavior >
			<munit-tools:mock-when doc:name="Mock when" doc:id="c8c290c8-a5a8-437f-b477-2b6aa24979dd" processor="http:request">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="HTTPS POST Translate Quote of the Day XML API" attributeName="doc:name" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:error typeId="HTTP:CONNECTIVITY" />
				</munit-tools:then-return>
			</munit-tools:mock-when>
		</munit:behavior>
		<munit:execution >
			<flow-ref doc:name="Flow Reference" doc:id="4aa0aaf1-e6f9-4675-a60d-4aaf667bd11d" name="sys-translate:\call-translation:Flow"/>
		</munit:execution>
		<munit:validation >
			<munit-tools:assert-that doc:name="Assert that" doc:id="24e09c63-d8dc-4a2a-9887-ebefe39aa892" is='#[MunitTools::equalTo("Translator service cannot be reached. Please try again later.")]' expression="#[payload.message]"/>
		</munit:validation>
	</munit:test>
	<munit:test name="sys-translate-test-suite:\call-translation-unauthorized:FlowTest" doc:id="35370102-3c26-486b-a1ef-e4277fb00710" expectedErrorType="HTTP:UNAUTHORIZED">
		<munit:behavior >
			<munit-tools:mock-when doc:name="Mock when" doc:id="1e68d3ad-a923-465c-b858-17276f84962b" processor="http:request">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="HTTPS POST Translate Quote of the Day XML API" attributeName="doc:name" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:error typeId="HTTP:UNAUTHORIZED" />
				</munit-tools:then-return>
			</munit-tools:mock-when>
		</munit:behavior>
		<munit:execution >
			<flow-ref doc:name="Flow Reference" doc:id="99ca77c5-b22d-4cb9-aa4a-d181214a9b21" name="sys-translate:\call-translation:Flow"/>
		</munit:execution>
		<munit:validation >
			<munit-tools:assert-that doc:name="Assert that" doc:id="ee546c64-3cfb-4044-a3a8-ec13bc25bf8d" is='#[MunitTools::equalTo("Translation request unauthorized. Please check if apikey used is still valid.")]' expression="#[payload.message]"/>
		</munit:validation>
	</munit:test>

</mule>
